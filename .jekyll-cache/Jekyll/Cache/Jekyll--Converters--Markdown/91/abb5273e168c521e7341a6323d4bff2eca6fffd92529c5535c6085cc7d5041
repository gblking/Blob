I"×<h2 id="æ¦‚è¿°">æ¦‚è¿°</h2>

<p>ä½¿ç”¨ typescript è¿›è¡Œ vue å¼€å‘ï¼Œæ™®é€šçš„ vue å¼€å‘æ¨¡å¼æ— æ³•äº«å—åˆ° typescript çš„ç‰¹æ€§ï¼Œå¦‚ï¼šç±»å‹æ£€æµ‹ã€ç±»å‹æ¨æ–­ã€‚ é€šè¿‡ä½¿ç”¨ class è¯­æ³•æœ‰åŠ©äºæˆ‘ä»¬å¾—åˆ° ts çš„ç±»å‹æ£€æµ‹ã€‚</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">v</span><span class="o">-</span><span class="nx">on</span><span class="p">:</span><span class="nx">click</span><span class="o">=</span><span class="dl">"</span><span class="s2">decrement</span><span class="dl">"</span><span class="o">&gt;-&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>    <span class="mi">8</span>
    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">v</span><span class="o">-</span><span class="nx">on</span><span class="p">:</span><span class="nx">click</span><span class="o">=</span><span class="dl">"</span><span class="s2">increment</span><span class="dl">"</span><span class="o">&gt;+&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>

<span class="c1">// Define the component in class-style</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Counter</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// Class properties will be component data</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="c1">// Methods will be component methods</span>
  <span class="nx">increment</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span>
  <span class="p">}</span>

  <span class="nx">decrement</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="o">--</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h2 id="æ–‡æ¡£">æ–‡æ¡£</h2>

<p><a href="https://www.tslang.cn/docs/home.html">TypeScript</a><br />
<a href="https://cli.vuejs.org/zh/guide/">Vue CLI</a><br />
<a href="https://class-component.vuejs.org/">vue_class_component</a><br />
<a href="https://github.com/kaorun343/vue-property-decorator">vue_property_decorator</a><br />
<a href="https://github.com/ktsn/vuex-class/">vuex-class</a></p>

<h2 id="å®‰è£…">å®‰è£…</h2>

<p>åˆ›å»ºé¡¹ç›®
<img src="http://localhost:4001/Blob/assets/images/post/20220112/0.png" alt="0" /></p>

<p>é€‰æ‹© â€œManually select featuresâ€<br />
<img src="http://localhost:4001/Blob/assets/images/post/20220112/1.png" alt="1" /></p>

<p>é€‰ä¸­ TypeScript åŠŸèƒ½ä»¥ä½¿ç”¨ Vue ç±»ç»„ä»¶ã€‚å¦‚æœéœ€è¦ï¼Œè¿˜å¯ä»¥æ·»åŠ å…¶ä»–åŠŸèƒ½ï¼š
<img src="http://localhost:4001/Blob/assets/images/post/20220112/2.png" alt="2" /></p>

<p>ä½¿ç”¨ class-style è¯­æ³•
<img src="http://localhost:4001/Blob/assets/images/post/20220112/3.png" alt="3" /></p>

<h2 id="vue-class-component">vue-class-component</h2>

<h3 id="general-guide">General Guide</h3>

<h4 id="component">@Component</h4>

<p><code class="language-plaintext highlighter-rouge">@Component</code> è£…é¥°å™¨åˆ›å»º Class Vue ç»„ä»¶ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// HelloWorld class will be a Vue component</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{}</span>
</code></pre></div></div>

<h4 id="data">Data</h4>

<p>åˆå§‹<code class="language-plaintext highlighter-rouge">data</code>å¯ä»¥å£°æ˜ä¸ºç±»å±æ€§ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// Declared as component data</span>
  <span class="nx">message</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Hello World!</span><span class="dl">'</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">æ³¨æ„ï¼š</code>å½“åˆå§‹åŒ–<code class="language-plaintext highlighter-rouge">data</code>æ•°æ®ä¸º<code class="language-plaintext highlighter-rouge">undefined</code>,ä½¿ç”¨ä¸Šé¢è¿™ç§æ–¹å¼çš„ï¼Œå½“å¯¹ data æ•°æ®è¿›è¡Œæ”¹å˜æ—¶æ— æ³•è¢«ç›‘å¬åˆ°ã€‚å¯ä½¿ç”¨<code class="language-plaintext highlighter-rouge">null</code>ä»£æ›¿æˆ–è€…ä½¿ç”¨<code class="language-plaintext highlighter-rouge">data</code> hook é’©å­ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// `message` will be reactive with `null` value</span>
  <span class="nx">message</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

  <span class="c1">// See Hooks section for details about `data` hook inside class.</span>
  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="c1">// `hello` will be reactive as it is declared via `data` hook.</span>
      <span class="na">hello</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="methods">Methods</h4>

<p><code class="language-plaintext highlighter-rouge">methods</code>å¯ä»¥ç›´æ¥å£°æ˜ä¸º class åŸå‹æ–¹æ³•ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">v</span><span class="o">-</span><span class="nx">on</span><span class="p">:</span><span class="nx">click</span><span class="o">=</span><span class="dl">"</span><span class="s2">hello</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">Click</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// Declared as component method</span>
  <span class="nx">hello</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello World!</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h4 id="computed">Computed</h4>

<p><code class="language-plaintext highlighter-rouge">computed</code>å¯ä»¥å£°æ˜ä¸º class çš„<code class="language-plaintext highlighter-rouge">getter/setter</code>å±æ€§ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">v</span><span class="o">-</span><span class="nx">model</span><span class="o">=</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">firstName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">John</span><span class="dl">'</span>
  <span class="nx">lastName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Doe</span><span class="dl">'</span>

  <span class="c1">// Declared as computed property getter</span>
  <span class="kd">get</span> <span class="nx">name</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span>
  <span class="p">}</span>

  <span class="c1">// Declared as computed property setter</span>
  <span class="kd">set</span> <span class="nx">name</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">splitted</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">firstName</span> <span class="o">=</span> <span class="nx">splitted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastName</span> <span class="o">=</span> <span class="nx">splitted</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="dl">''</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h4 id="hooks">Hooks</h4>

<p><code class="language-plaintext highlighter-rouge">data</code>, <code class="language-plaintext highlighter-rouge">render</code> å’Œå…¶ä»– Vue ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°éƒ½å¯ä»¥åœ¨ class ä¸­ç›´æ¥å£°æ˜</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// Declare mounted lifecycle hook</span>
  <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">mounted</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Declare render function</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="nx">World</span><span class="o">!&lt;</span><span class="sr">/div&gt;</span><span class="err">;
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="components">Components</h4>

<p>å¼•å…¥ components:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="nx">OtherComponent</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">OtherComponent</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./OtherComponent.vue</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
 <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
   <span class="nx">OtherComponent</span>
 <span class="p">}</span>
<span class="p">})</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h4 id="additional-hooks">Additional Hooks</h4>

<p>å½“ä½¿ç”¨ä¸€äº› Vue æ’ä»¶ï¼Œå¦‚ï¼š<code class="language-plaintext highlighter-rouge">Vue Router</code>ï¼Œå¸Œæœ› class ç±»ç»„ä»¶è§£æå®ƒä»¬æä¾›çš„ hooks é’©å­ï¼Œå¯é€šè¿‡<code class="language-plaintext highlighter-rouge">Component.registerHooks</code>å¯¹æ­¤ç±»é’©å­è¿›è¡Œæ³¨å†Œ:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// class-component-hooks.js</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Register the router hooks with their names</span>
<span class="nx">Component</span><span class="p">.</span><span class="nx">registerHooks</span><span class="p">([</span>
  <span class="dl">"</span><span class="s2">beforeRouteEnter</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">beforeRouteLeave</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">beforeRouteUpdate</span><span class="dl">"</span><span class="p">,</span>
<span class="p">]);</span>
</code></pre></div></div>

<p>åœ¨<code class="language-plaintext highlighter-rouge">main.js</code>ä¸­é¡¶éƒ¨ä½ç½®é€šè¿‡<code class="language-plaintext highlighter-rouge">import</code>å¼•å…¥æ³¨å†Œæ–‡ä»¶ï¼Œ<code class="language-plaintext highlighter-rouge">æ³¨:</code>æ³¨å†Œæ–‡ä»¶éœ€åœ¨å…¶ä»–ç»„ä»¶å‰å¼•å…¥ï¼Œå³æ”¾åœ¨é¡¶éƒ¨ä½ç½®å¼•å…¥ï¼Œç¡®ä¿æ‰§è¡Œé¡ºåº</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// main.js</span>

<span class="c1">// Make sure to register before importing any components</span>
<span class="k">import</span> <span class="dl">"</span><span class="s2">./class-component-hooks</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./App</span><span class="dl">"</span><span class="p">;</span>

<span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
  <span class="na">el</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#app</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">render</span><span class="p">:</span> <span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">h</span><span class="p">(</span><span class="nx">App</span><span class="p">),</span>
<span class="p">});</span>
</code></pre></div></div>

<p>class ç±»ç»„ä»¶å°†å…¶å®ç°ä¸ºç±»åŸå‹æ–¹æ³•ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// The class component now treats beforeRouteEnter,</span>
  <span class="c1">// beforeRouteUpdate and beforeRouteLeave as Vue Router hooks</span>
  <span class="nx">beforeRouteEnter</span><span class="p">(</span><span class="nx">to</span><span class="p">,</span> <span class="k">from</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">beforeRouteEnter</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">beforeRouteUpdate</span><span class="p">(</span><span class="nx">to</span><span class="p">,</span> <span class="k">from</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">beforeRouteUpdate</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">beforeRouteLeave</span><span class="p">(</span><span class="nx">to</span><span class="p">,</span> <span class="k">from</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">beforeRouteLeave</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="è‡ªå®šä¹‰-decorators">è‡ªå®šä¹‰ Decorators</h4>

<p>è‡ªå®šä¹‰ decorators è£…é¥°å™¨æ¥æ‰©å±•åŠŸèƒ½ã€‚æä¾›<code class="language-plaintext highlighter-rouge">createDecorator</code>åˆ›å»ºè‡ªå®šä¹‰è£…é¥°å™¨ï¼Œéœ€è¦ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå›è°ƒå‡½æ•°æ¥æ”¶ä»¥ä¸‹å‚æ•°ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">options</code>ï¼šVue ç»„ä»¶ options å¯¹è±¡ï¼Œä¿®æ”¹æ­¤å¯¹è±¡ä¼šå½±å“æä¾›è¯¥å¯¹è±¡çš„ç»„ä»¶</li>
  <li><code class="language-plaintext highlighter-rouge">key</code>ï¼šåº”ç”¨è¯¥è£…é¥°å™¨çš„å±æ€§æˆ–æ–¹æ³•é”®</li>
  <li><code class="language-plaintext highlighter-rouge">parameterIndex</code>ï¼šè£…é¥°å‚æ•°çš„ç´¢å¼•å¦‚æœè‡ªå®šä¹‰è£…é¥°å™¨ä½œä¸ºå‚æ•°ä½¿ç”¨</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// decorators.js</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">createDecorator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Declare Log decorator.</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">Log</span> <span class="o">=</span> <span class="nx">createDecorator</span><span class="p">((</span><span class="nx">options</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// Keep the original method for later.</span>
  <span class="kd">const</span> <span class="nx">originalMethod</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">methods</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>

  <span class="c1">// Wrap the method with the logging logic.</span>
  <span class="nx">options</span><span class="p">.</span><span class="nx">methods</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">wrapperMethod</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Print a log.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Invoked: </span><span class="p">${</span><span class="nx">key</span><span class="p">}</span><span class="s2">(`</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">,</span> <span class="dl">"</span><span class="s2">)</span><span class="dl">"</span><span class="p">);</span>

    <span class="c1">// Invoke the original method.</span>
    <span class="nx">originalMethod</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">});</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Log</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./decorators</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="kd">class</span> <span class="nx">MyComp</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// It prints a log when `hello` method is invoked.</span>
  <span class="p">@</span><span class="nd">Log</span>
  <span class="nx">hello</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// è°ƒç”¨</span>
<span class="nx">hello</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>

<span class="c1">// è¾“å‡º</span>
<span class="nl">Invoked</span><span class="p">:</span> <span class="nx">hello</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="extend-and-mixins">Extend and Mixins</h4>

<p><strong>Extend</strong><br />
ä½¿ç”¨ Extend è¿›è¡Œç±»ç»§æ‰¿</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// super.js</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Define a super class component</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Super</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">superValue</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Hello</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Mixins</strong></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// mixins.js</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// You can declare mixins as the same style as components.</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">Hello</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">hello</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Hello</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">World</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">world</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">World</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Component</span><span class="p">,</span> <span class="p">{</span> <span class="nx">mixins</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Hello</span><span class="p">,</span> <span class="nx">World</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./mixins</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Use `mixins` helper function instead of `Vue`.</span>
<span class="c1">// `mixins` can receive any number of arguments.</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">HelloWorld</span> <span class="kd">extends</span> <span class="nx">mixins</span><span class="p">(</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">World</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hello</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> </span><span class="dl">"</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">world</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">!</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// -&gt; Hello World!</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h4>

<p><strong>this</strong><br />
ç®­å¤´å‡½æ•°ä¸­ä½¿ç”¨ this è·å–åˆå§‹å±æ€§å€¼ï¼Œæ— æ³•è·å–ã€‚è¿™æ˜¯å› ä¸ºåœ¨åˆå§‹åŒ–ç±»å±æ€§æ—¶ï¼Œè¿™åªæ˜¯ Vue çš„ä»£ç†å¯¹è±¡ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyComp</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">foo</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span>

  <span class="c1">// DO NOT do this</span>
  <span class="nx">bar</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Does not update the expected property.</span>
    <span class="c1">// `this` value is not a Vue instance in fact.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="mi">456</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä½¿ç”¨æ™®é€šæ–¹æ³•ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">MyComp</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">foo</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span>

  <span class="c1">// DO this</span>
  <span class="nx">bar</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Correctly update the expected property.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="mi">456</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>constructor</strong></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue-class-component</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Posts</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">posts</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="c1">// DO NOT do this</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">/posts.json</span><span class="dl">"</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">posts</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="nx">posts</span><span class="p">;</span>
      <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ç”±äº Vue class component å·¥ä½œæ–¹å¼ï¼Œä¸Šé¢çš„ä»£ç å°†ä¼šè°ƒç”¨ä¸¤æ¬¡ã€‚<br />
å¯å°†ä¸Šé¢çš„ä»£ç  constructor ç”¨ create æ›¿æ¢ã€‚</p>

<h3 id="typescript-guide">TypeScript Guide</h3>

<h4 id="props-å®šä¹‰">Props å®šä¹‰</h4>

<p>vue-class-component æ²¡æœ‰æä¾›ä¸“é—¨çš„ API ç”¨äºå®šä¹‰ Props,å¯ä»¥ä½¿ç”¨ Vue.extend APIï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">lang</span><span class="o">=</span><span class="dl">"</span><span class="s2">ts</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>

<span class="c1">// Define the props by using Vue's canonical way.</span>
<span class="kd">const</span> <span class="nx">GreetingProps</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="nb">String</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="c1">// Use defined props by extending GreetingProps.</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Greeting</span> <span class="kd">extends</span> <span class="nx">GreetingProps</span> <span class="p">{</span>
  <span class="kd">get</span> <span class="nx">message</span><span class="p">():</span> <span class="nx">string</span> <span class="p">{</span>
    <span class="c1">// this.name will be typed</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">Hello, </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">æˆ–</code></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">lang</span><span class="o">=</span><span class="dl">"</span><span class="s2">ts</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span><span class="p">,</span> <span class="p">{</span> <span class="nx">mixins</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Super</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./super</span><span class="dl">'</span>

<span class="c1">// Define the props by using Vue's canonical way.</span>
<span class="kd">const</span> <span class="nx">GreetingProps</span> <span class="o">=</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="nb">String</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="c1">// Use `mixins` helper to combine defined props and a mixin.</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Greeting</span> <span class="kd">extends</span> <span class="nx">mixins</span><span class="p">(</span><span class="nx">GreetingProps</span><span class="p">,</span> <span class="nx">Super</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">get</span> <span class="nx">message</span><span class="p">():</span> <span class="nx">string</span> <span class="p">{</span>
    <span class="c1">// this.name will be typed</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">Hello, </span><span class="dl">'</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h4 id="å±æ€§ç±»å‹å£°æ˜">å±æ€§ç±»å‹å£°æ˜</h4>

<p>æœ‰æ—¶æ‚¨å¿…é¡»åœ¨ vue-class-component ä¹‹å¤–å®šä¹‰ç»„ä»¶å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚ï¼šVuex æä¾›çš„ MapGetter å’Œ mapActionsï¼Œéœ€è¦åœ¨ç»„ä»¶ options å¯¹è±¡ä¸­ä½¿ç”¨ã€‚<br />
å¯é€šè¿‡å°†ç»„ä»¶ options ä¼ é€’ç»™<code class="language-plaintext highlighter-rouge">@component</code>ä½œä¸º decorator çš„å‚æ•°ï¼Œä½†æ˜¯ properties å’Œ methods åœ¨è¿è¡Œæ—¶ä¸ä¼šè‡ªåŠ¨å£°æ˜ï¼Œéœ€è¦åœ¨ class ç±»ç»„ä»¶ä¸­è¿›è¡Œå£°æ˜ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">mapGetters</span><span class="p">,</span> <span class="nx">mapActions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span>

<span class="c1">// Interface of post</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Post</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./post</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">computed</span><span class="p">:</span> <span class="nx">mapGetters</span><span class="p">([</span>
    <span class="dl">'</span><span class="s1">posts</span><span class="dl">'</span>
  <span class="p">]),</span>

  <span class="na">methods</span><span class="p">:</span> <span class="nx">mapActions</span><span class="p">([</span>
    <span class="dl">'</span><span class="s1">fetchPosts</span><span class="dl">'</span>
  <span class="p">])</span>
<span class="p">})</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Posts</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// Declare mapped getters and actions on type level.</span>
  <span class="c1">// You may need to add `!` after the property name</span>
  <span class="c1">// to avoid compilation error (definite assignment assertion).</span>

  <span class="c1">// Type the mapped posts getter.</span>
  <span class="nx">posts</span><span class="o">!</span><span class="p">:</span> <span class="nx">Post</span><span class="p">[]</span>

  <span class="c1">// Type the mapped fetchPosts action.</span>
  <span class="nx">fetchPosts</span><span class="o">!</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>

  <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Use the mapped getter and action.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fetchPosts</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">posts</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="refs-ç±»å‹æ‰©å±•">$refs ç±»å‹æ‰©å±•</h4>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="dl">"</span><span class="s2">input</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">lang</span><span class="o">=</span><span class="dl">"</span><span class="s2">ts</span><span class="dl">"</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Component</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue-class-component</span><span class="dl">'</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">InputFocus</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="c1">// annotate refs type.</span>
  <span class="c1">// The symbol `!` (definite assignment assertion)</span>
  <span class="c1">// is needed to get rid of compilation error.</span>
  <span class="nx">$refs</span><span class="o">!</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">input</span><span class="p">:</span> <span class="nx">HTMLInputElement</span>
  <span class="p">}</span>

  <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Use `input` ref without type cast.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h4 id="hooks-auto-complete">Hooks Auto-complete</h4>

<p>Vue Class Component æä¾›äº†å†…ç½®çš„ hook ç±»å‹, å¯ä»¥åœ¨ class component å£°æ˜ä¸­ä¸º TypeScript è‡ªåŠ¨å®Œæˆ<code class="language-plaintext highlighter-rouge">data</code>ã€<code class="language-plaintext highlighter-rouge">render</code>å’Œå…¶ä»–ç”Ÿå‘½å‘¨æœŸé’©å­(hooks)ã€‚é€šè¿‡å¼•å…¥<code class="language-plaintext highlighter-rouge">vue-class-component/hooks</code>å¯ç”¨ã€‚</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// main.ts</span>
<span class="k">import</span> <span class="dl">"</span><span class="s2">vue-class-component/hooks</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// import hooks type to enable auto-complete</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./App.vue</span><span class="dl">"</span><span class="p">;</span>

<span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
  <span class="na">render</span><span class="p">:</span> <span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">h</span><span class="p">(</span><span class="nx">App</span><span class="p">),</span>
<span class="p">}).</span><span class="nx">$mount</span><span class="p">(</span><span class="dl">"</span><span class="s2">#app</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="åœ¨-decorator-ä¸­æ³¨é‡Š-component-ç±»å‹">åœ¨ Decorator ä¸­æ³¨é‡Š Component ç±»å‹</h4>

<p>æœ‰æ—¶å€™æ‚¨éœ€è¦åœ¨<code class="language-plaintext highlighter-rouge">@component</code> decorator å‚æ•°ä¸­çš„å‡½æ•°ä¸Šä½¿ç”¨ç»„ä»¶ç±»å‹ï¼Œå¦‚ä¸‹ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">watch</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">postId</span><span class="p">(</span><span class="na">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// To fetch post data when the id is changed.</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">fetchPost</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span> <span class="c1">// -&gt; Property 'fetchPost' does not exist on type 'Vue'.</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">})</span>
<span class="kd">class</span> <span class="nx">Post</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nl">postId</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>

  <span class="nx">fetchPost</span><span class="p">(</span><span class="nx">postId</span><span class="p">:</span> <span class="nx">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä¸Šé¢çš„ä»£ç ç”Ÿæˆäº†ä¸€ä¸ªé”™è¯¯ï¼Œè¯¥é”™è¯¯æŒ‡ç¤º watch å¤„ç†ç¨‹åºä¸­ï¼Œä¸å­˜åœ¨ fetchPostã€‚ä¹‹æ‰€ä»¥å‘ç”Ÿè¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸º<code class="language-plaintext highlighter-rouge">@Component</code> decorator å‚æ•°æ˜¯<code class="language-plaintext highlighter-rouge">Vue</code>ç±»å‹ã€‚è¦ä½¿ç”¨è‡ªå·±çš„ç»„ä»¶ç±»å‹(å³ä¸Šè¿°ç¤ºä¾‹çš„ Post)ï¼Œå¯ä»¥é€šè¿‡å…¶ç±»å‹å‚æ•°å¯¹è£…é¥°å™¨è¿›è¡Œæ³¨é‡Šã€‚</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Annotate the decorator with the component type 'Post' so that `this` type in</span>
<span class="c1">// the decorator argument becomes 'Post'.</span>
<span class="p">@</span><span class="nd">Component</span><span class="o">&lt;</span><span class="nx">Post</span><span class="o">&gt;</span><span class="p">({</span>
  <span class="na">watch</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">postId</span><span class="p">(</span><span class="na">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">fetchPost</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="c1">// -&gt; No errors</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">})</span>
<span class="kd">class</span> <span class="nx">Post</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nl">postId</span><span class="p">:</span> <span class="nx">string</span>

  <span class="nx">fetchPost</span><span class="p">(</span><span class="nx">postId</span><span class="p">:</span> <span class="nx">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
:ET